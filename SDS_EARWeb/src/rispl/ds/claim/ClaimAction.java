package rispl.ds.claim;

import rispl.ds.ReasonCodes;
import java.util.Date;
import util.email.ClaimEmail;
import rispl.dk.itemLookUp.PLUItemIfc;
import rispl.dkservices.common.SearchCriteriaIfc;
import rispl.dkart.services.ejb.LookUpItemIfc;
import rispl.dkservices.common.SearchCriteria;
import java.util.LinkedHashMap;
import java.io.Serializable;
import org.apache.commons.lang3.SerializationUtils;
import java.util.Collection;
import java.util.Iterator;
import rispl.db.model.claim.ClaimTranLineItem;
import rispl.dime.schedular.imports.DKartConstantsIfc;
import java.text.DecimalFormat;
import rispl.dkart.services.entities.transaction.OrderTranDiscountItem;
import rispl.db.model.claim.ClaimTranDscItm;
import java.math.RoundingMode;
import utility.ConfigUtils;
import java.math.MathContext;
import rispl.dkart.services.entities.transaction.OrderTranLineItem;
import java.util.ArrayList;
import sds.struts.simpleobjects.claim.ClaimItem;
import rispl.dk.Employee.EmployeeIfc;
import rispl.dkart.services.entities.transaction.OrderTranHeader;
import rispl.dkservices.common.OrderTransactionSearchCriteriaIfc;
import rispl.dkservices.common.EmployeeSearchCriteriaIfc;
import rispl.dkart.services.ejb.LookUpEmployeeIfc;
import rispl.dkart.services.ejb.transaction.OrderTransactionsIfc;
import rispl.dkart.services.ejb.claim.ClaimRemote;
import rispl.db.model.claim.ClaimTranSum;
import org.apache.struts2.json.JSONWriter;
import java.util.List;
import rispl.dkart.services.entities.customer.CustomerSiteInvoice;
import rispl.dkservices.common.OrderTransactionSearchCriteria;
import rispl.dkservices.common.EmployeeSearchCriteria;
import rispl.ds.context.DKartContext;
import java.util.HashMap;
import org.apache.logging.log4j.LogManager;
import rispl.db.model.claim.ClaimTranHeader;
import java.util.Map;
import java.math.BigDecimal;
import sds.struts.simpleobjects.claim.Claim;
import org.apache.logging.log4j.Logger;
import rispl.ds.DSAction;

public class ClaimAction extends DSAction
{
    static final Logger LOGGER;
    private Claim newClaim;
    BigDecimal[] claimTotals;
    private String invoiceOrOrderID;
    private Map<String, String> returnReasonCodesMap;
    private ClaimTranHeader claimHeader;
    private String claimJson;
    private String serviceItemID;
    private String returnReasoncodes;
    private Boolean RegClaimPerWthOutInv;
    private boolean managerOverride;
    private Map<String, String> priceChangeReasonCodeMap;
    private String salesAgentName;
    private String site_address;
    
    static {
        LOGGER = LogManager.getLogger((Class)ClaimAction.class);
    }
    
    public ClaimAction() {
        this.claimTotals = new BigDecimal[] { new BigDecimal("0.00"), new BigDecimal("0.00"), new BigDecimal("0.00"), new BigDecimal("0.00") };
        this.returnReasonCodesMap = new HashMap<String, String>();
    }
    
    public String execute() throws Exception {
        return "success";
    }
    
    public String invoiceSearchByOrderOrInvoice() {
        List<ClaimTranSum> claimTranSumList = null;
        try {
            final String ClaimPerWthOutInv = DKartContext.getParamterBean().fetchXMLParameterValues().getEnableClaimWithOutInvoice();
            if (ClaimPerWthOutInv != null && ClaimPerWthOutInv.equalsIgnoreCase("yes")) {
                this.setRegClaimPerWthOutInv(true);
            }
            final ClaimRemote claimRemote = DKartContext.getClaimBean();
            claimTranSumList = (List<ClaimTranSum>)claimRemote.findClaimWithInvoiceID(this.invoiceOrOrderID);
            if (claimTranSumList != null) {
                this.addActionMessage("Claim has already been generated for the Invoice Number:" + this.invoiceOrOrderID);
                ClaimAction.LOGGER.info("Claim has already been generated for the Invoice Number:" + this.invoiceOrOrderID);
            }
            else {
                claimTranSumList = (List<ClaimTranSum>)claimRemote.findClaimWithOrderID(this.invoiceOrOrderID);
                if (claimTranSumList != null) {
                    this.addActionMessage("Claim has already been generated for the Order Number:" + this.invoiceOrOrderID);
                    ClaimAction.LOGGER.info("Claim has already been generated for the Order Number:" + this.invoiceOrOrderID);
                }
            }
        }
        catch (Exception e1) {
            ClaimAction.LOGGER.error(e1.getMessage());
        }
        try {
            final OrderTransactionsIfc trans = DKartContext.getLookupOrder();
            final LookUpEmployeeIfc lkupemp = DKartContext.getLookupEmployee();
            final EmployeeSearchCriteriaIfc empcrt = (EmployeeSearchCriteriaIfc)new EmployeeSearchCriteria();
            final OrderTransactionSearchCriteriaIfc search = (OrderTransactionSearchCriteriaIfc)new OrderTransactionSearchCriteria();
            search.setSearchByinvoiceNumberOrOrderNumber(true);
            search.setInvoiceNumberOrOrderNumber(this.invoiceOrOrderID);
            final OrderTranHeader[] orders = trans.getTransactionsInvoices(search);
            if (orders != null && orders.length > 0) {
                if (orders[0].getScOrd().compareTo(new BigDecimal(7)) == 0) {
                    if (orders[0].getCustomer().getSiteInvoices() != null && orders[0].getCustomer().getSiteInvoices().size() > 0 && orders[0].getOrdTranLineItems() != null && orders[0].getOrdTranLineItems().size() > 0) {
                        (this.newClaim = new Claim()).setClaimStatus(Integer.valueOf(0));
                        this.newClaim.setCustomerID(orders[0].getCustomer().getCustomerHeader().getCustomerHeaderPK().getCustId());
                        this.newClaim.setCustomerName(orders[0].getCustomer().getCustomerHeader().getCtNm());
                        this.newClaim.setSite_address(trans.getCustomerSiteAddrss(orders[0].getCustomer().getCustomerHeader().getCustomerHeaderPK().getCustId(), orders[0].getIdBtchInvResv()));
                        this.newClaim.setSiteId(orders[0].getIdBtchInvResv());
                        this.newClaim.setCustomerSegment(orders[0].getCustomer().getCustomerSegmentID());
                        this.newClaim.setOriginalInvoiceID(orders[0].getCustomer().getSiteInvoices().get(0).getArInvNum());
                        if (orders[0].getOrdTranSum() != null) {
                            this.newClaim.setOriginalOrderID(orders[0].getOrdTranSum().getIdOrd());
                        }
                        this.newClaim.setClaimItemsList((List)this.getClaimItemsList(orders[0], claimTranSumList));
                        this.newClaim.setSalesAgentId(orders[0].getEmId());
                        empcrt.setEmployeeId(orders[0].getEmId());
                        final EmployeeIfc[] emp = lkupemp.lookupSalesAgent(empcrt);
                        if (emp != null && emp.length > 0) {
                            this.newClaim.setSalesAgent(emp[0].getEmployeeName());
                        }
                        if (orders[0].getReasonCodes() != null && orders[0].getReasonCodes().containsKey("Returns")) {
                            this.setReturnReasonCodesMap(orders[0].getReasonCodes().get("Returns"));
                            this.putInSession(DSAction.SESSION.RETURN_REASONCODE_MAP, (Object)this.returnReasonCodesMap);
                        }
                    }
                    else {
                        this.addActionError("No orders/invoices were found with this information.");
                    }
                }
                else {
                    this.addActionError("Order is not eligible for claim.");
                }
            }
            else {
                this.addActionError("No orders/invoices were found with this information.");
            }
            try {
                if (orders.length == 0) {
                    final OrderTransactionsIfc ordTrn = DKartContext.getLookupOrder();
                    this.setReturnReasonCodesMap(ordTrn.getAllReasonCodes().get(this.getText("returns.reasonCode.group.name")));
                }
                final JSONWriter writer = new JSONWriter();
                this.returnReasoncodes = writer.write((Object)this.returnReasonCodesMap);
            }
            catch (Exception e2) {
                e2.printStackTrace();
            }
        }
        catch (Exception e3) {
            this.addActionError("Oops! Their is a problem while looking for orders/invoices");
            ClaimAction.LOGGER.error(e3.getMessage());
        }
        return "success";
    }
    
    private List<ClaimItem> getClaimItemsList(final OrderTranHeader ordTranHeader, List<ClaimTranSum> existingClaimList) throws Exception {
        BigDecimal ordExtDscLnItm = BigDecimal.ZERO;
        List<ClaimItem> claimItemsList = new ArrayList<ClaimItem>();
        final Map<String, String> discountReasonCodeMap = ordTranHeader.getReasonCodes().get("Discount");
        for (final OrderTranLineItem lineItem : ordTranHeader.getOrdTranLineItems()) {
            if (lineItem.getItmTy().compareTo(new BigDecimal(2)) != 0) {
                final ClaimItem claimItem = new ClaimItem();
                claimItem.setItemID(lineItem.getItemId());
                claimItem.setItemDescription(lineItem.getDeItmShrtRcpt());
                claimItem.setQuantitySold(lineItem.getLineQnt());
                claimItem.setClaimQuantityRegistered(claimItem.getQuantitySold());
                ordExtDscLnItm = lineItem.getExtnDscLnItm();
                final BigDecimal priceSoldAt = ordExtDscLnItm.divide(lineItem.getLineQnt(), MathContext.DECIMAL64);
                //final BigDecimal zero = ConfigUtils.getInstance().createBigDecimal((Object)0, "format.currency");
                //claimItem.setPriceSoldAt(priceSoldAt.setScale(zero.scale(), RoundingMode.HALF_EVEN));
                //Kunal : (-) sign in claim
                claimItem.setPriceSoldAt(priceSoldAt);
                claimItem.setNetPrice(lineItem.getExtnDscLnItm());
                if (lineItem.getOverRidePrice() == null) {
                    claimItem.setUnitPrice(lineItem.getItmPrnPrc());
                }
                else {
                    claimItem.setUnitPrice(lineItem.getOverRidePrice());
                }
                claimItem.setClaimReasonCode(lineItem.getRcRtnMr());
                claimItem.setTaxAmount(lineItem.getVatLnItmRtn());
                if (!lineItem.getOrdTranDscItms().isEmpty() && lineItem.getOrdTranDscItms() != null) {
                    final List<ClaimTranDscItm> dscList = new ArrayList<ClaimTranDscItm>();
                    for (final OrderTranDiscountItem ordDsc : lineItem.getOrdTranDscItms()) {
                        final ClaimTranDscItm clmDsc = new ClaimTranDscItm();
                        clmDsc.setDscAmt(ordDsc.getDscAmt());
                        final BigDecimal unitDiscAmt = clmDsc.getDscAmt().divide(claimItem.getQuantitySold(), MathContext.DECIMAL64);
                        final DecimalFormat fmt = new DecimalFormat(ConfigUtils.getInstance().getCurrencyFormat());
                        //fmt.setRoundingMode(RoundingMode.HALF_EVEN);
                        //clmDsc.setUnitDscAmt(new BigDecimal(fmt.format(unitDiscAmt)));
                        //Kunal : (-) sign in claim
                        clmDsc.setUnitDscAmt(unitDiscAmt);
                        clmDsc.setDscPer(ordDsc.getDscPer());
                        clmDsc.setPrmCmpDtlid(ordDsc.getPrmCmpDtlid());
                        clmDsc.setTyDsc(ordDsc.getTyDsc());
                        clmDsc.setPrmCmpId(ordDsc.getPrmCmpId());
                        clmDsc.setPrmId(ordDsc.getPrmId());
                        clmDsc.setPrmType(ordDsc.getPrmType());
                        if (clmDsc.getPrmId() == null) {
                            clmDsc.setPrmType(BigDecimal.ZERO);
                            
                        }
                        clmDsc.setSrcTrgList(ordDsc.getSrcTrgList());
                        clmDsc.setPrmDesc(ordDsc.getPrmDesc());
                        if (ordDsc.getTyDsc().compareTo(DKartConstantsIfc.DIS_PROM_AUTO) == 0) {
                            claimItem.setDiscountAmount(ordDsc.getDscAmt());
                            claimItem.setDiscountPercent(ordDsc.getDscPer());
                            if (ordDsc.getPrmType().compareTo(DKartConstantsIfc.DIS_PROM_MNUL) == 0) {
                                claimItem.setTranDiscDsc(discountReasonCodeMap.get(ordDsc.getDiscReasonCode()).toUpperCase());
                            }
                            else {
                                claimItem.setTranDiscDsc(ordDsc.getPrmDesc());
                            }
                        }
                        else if (ordDsc.getTyDsc().compareTo(DKartConstantsIfc.DIS_PROM_MNUL) == 0) {
                            claimItem.setItemLevelDiscAmt(ordDsc.getDscAmt());
                            claimItem.setItemLevelDiscPer(ordDsc.getDscPer());
                            claimItem.setItemDiscDsc(discountReasonCodeMap.get(ordDsc.getDiscReasonCode()).toUpperCase());
                        }
                        clmDsc.setDiscReasonCode(ordDsc.getDiscReasonCode());
                        dscList.add(clmDsc);
                    }
                    claimItem.setDscList((List)dscList);
                }
                claimItemsList.add(claimItem);
            }
        }
        //Kunal: (-) sign in claim
        //claimItemsList = this.reAssignClaimItems(claimItemsList);
        if (existingClaimList != null) {
            ClaimAction.LOGGER.info("Existed claim line items are available and refreshing the claim line items");
            existingClaimList = this.removeRejectClaims(existingClaimList);
            try {
                for (final ClaimTranSum existingClaim : existingClaimList) {
                    if (existingClaim != null && existingClaim.getClaimTranHeader() != null && existingClaim.getClaimTranHeader().getClaimTranLineItems() != null) {
                        for (final ClaimTranLineItem claimTranLineItem : existingClaim.getClaimTranHeader().getClaimTranLineItems()) {
                            BigDecimal totDisc = BigDecimal.ZERO;
                            for (final ClaimTranDscItm dscItm : claimTranLineItem.getClaimTranDscItms()) {
                                if (dscItm.getTyDsc().compareTo(BigDecimal.ZERO) == 0) {
                                    totDisc = totDisc.add(dscItm.getUnitDscAmt());
                                }
                                else {
                                    if (dscItm.getTyDsc().compareTo(BigDecimal.ONE) != 0) {
                                        continue;
                                    }
                                    totDisc = totDisc.add(dscItm.getUnitDscAmt());
                                }
                            }
                            for (final ClaimItem claimItem2 : claimItemsList) {
                                final BigDecimal soldAt = claimTranLineItem.getItmPrnPrc().subtract(totDisc);
                                if (claimItem2.getItemID().equalsIgnoreCase(claimTranLineItem.getItemId()) && claimItem2.getPriceSoldAt().compareTo(soldAt) == 0) {
                                    if (claimTranLineItem.getApprClaimQty() != null) {
                                        claimItem2.setQuantitySold(claimItem2.getQuantitySold().subtract(claimTranLineItem.getApprClaimQty()));
                                        if (claimItem2.getQuantitySold().intValue() < 0) {
                                            claimItem2.setQuantitySold(BigDecimal.ZERO);
                                        }
                                    }
                                    else if (!claimItem2.getQuantitySold().toString().equals("0")) {
                                        claimItem2.setQuantitySold(claimItem2.getQuantitySold().subtract(claimTranLineItem.getLineQntRtn()));
                                    }
                                    claimItem2.setClaimQuantityRegistered(claimItem2.getQuantitySold());
                                    claimItem2.setNetPrice(claimItem2.getPriceSoldAt().multiply(claimItem2.getQuantitySold()));
                                    if (claimItem2.getDscList() == null || claimItem2.getDscList().size() <= 0) {
                                        continue;
                                    }
                                    for (final ClaimTranDscItm dscItm2 : claimItem2.getDscList()) {
                                        if (dscItm2.getTyDsc().compareTo(BigDecimal.ZERO) == 0) {
                                            claimItem2.setItemLevelDiscAmt(dscItm2.getUnitDscAmt().multiply(claimItem2.getQuantitySold()));
                                        }
                                        else if (dscItm2.getTyDsc().compareTo(BigDecimal.ONE) == 0) {
                                            claimItem2.setDiscountAmount(dscItm2.getUnitDscAmt().multiply(claimItem2.getQuantitySold()));
                                        }
                                        dscItm2.setDscAmt(dscItm2.getUnitDscAmt().multiply(claimItem2.getQuantitySold()));
                                        ClaimAction.LOGGER.info("discounts also refreshed for existed claimlineitem sequence ");
                                    }
                                }
                            }
                        }
                    }
                }
            }
            catch (Exception e) {
                ClaimAction.LOGGER.error("Their is a problem while refreshing the existed claimLineItems, " + e.getMessage());
                throw new Exception("Their is a problem while refreshing the existed claimLineItems ");
            }
        }
        return claimItemsList;
    }
    
    public List<ClaimItem> reAssignClaimItems(final List<ClaimItem> oldClaimItems) throws Exception {
        final List<ClaimItem> reAssignedClaimLines = new ArrayList<ClaimItem>();
        try {
            for (final ClaimItem claimItem : oldClaimItems) {
                final BigDecimal qty = claimItem.getQuantitySold();
                final int bigDecimalSign = claimItem.getPriceSoldAt().multiply(qty).compareTo(claimItem.getNetPrice());
                ClaimAction.LOGGER.info("Checking whether items needs to split or not based on decimals calculation, ITEM : " + claimItem.getItemID());
                if (qty.intValue() > 1 && bigDecimalSign != 0) {
                    ClaimAction.LOGGER.info("Item " + claimItem.getItemID() + " will be splitted");
                    reAssignedClaimLines.addAll(this.splitAndGroupLineItems(claimItem));
                }
                else {
                    reAssignedClaimLines.add(claimItem);
                }
            }
        }
        catch (Exception e) {
            ClaimAction.LOGGER.error(e.getMessage());
            throw new Exception("problem during re-assigning the claimItems, " + e.getMessage());
        }
        return reAssignedClaimLines;
    }
    
    public List<ClaimItem> splitAndGroupLineItems(final ClaimItem claimItem) {
        ClaimAction.LOGGER.info("Method splitAndGroupLineItems is started executing to split the line items");
        final List<ClaimItem> splittedLines = new ArrayList<ClaimItem>();
        final List<ClaimItem> groupedLineItems = new ArrayList<ClaimItem>();
        BigDecimal qtyTot = claimItem.getQuantitySold();
        BigDecimal totPrice = claimItem.getNetPrice();
        BigDecimal manualDiscountTot = claimItem.getItemLevelDiscAmt();
        BigDecimal tranDiscountTot = claimItem.getDiscountAmount();
        final int scaleToAllow = ConfigUtils.getInstance().createBigDecimal((Object)0, "format.currency").scale();
        final BigDecimal splittedQty = BigDecimal.ONE;
        while (qtyTot.intValue() != 0) {
            final ClaimItem clmItem = (ClaimItem)SerializationUtils.clone((Serializable)claimItem);
            clmItem.setQuantitySold(splittedQty);
            clmItem.setClaimQuantityRegistered(splittedQty);
            final BigDecimal soldAt = claimItem.getNetPrice().divide(claimItem.getQuantitySold(), scaleToAllow, RoundingMode.HALF_EVEN);
            if (qtyTot.compareTo(BigDecimal.ONE) == 0) {
                clmItem.setPriceSoldAt(totPrice);
                totPrice = BigDecimal.ZERO;
            }
            else {
                clmItem.setPriceSoldAt(soldAt);
                totPrice = totPrice.subtract(soldAt);
            }
            clmItem.setNetPrice(clmItem.getPriceSoldAt().multiply(splittedQty));
            if (claimItem.getDscList() != null) {
                try {
                    final List<ClaimTranDscItm> clmDscList = new ArrayList<ClaimTranDscItm>();
                    for (final ClaimTranDscItm dscItem1 : claimItem.getDscList()) {
                        final ClaimTranDscItm dscItem2 = (ClaimTranDscItm)SerializationUtils.clone((Serializable)dscItem1);
                        final BigDecimal unitDscAmt = dscItem2.getDscAmt().divide(claimItem.getQuantitySold(), scaleToAllow, RoundingMode.HALF_UP);
                        if (dscItem2.getTyDsc().compareTo(BigDecimal.ZERO) == 0) {
                            if (qtyTot.compareTo(BigDecimal.ONE) == 0) {
                                dscItem2.setUnitDscAmt(manualDiscountTot);
                                manualDiscountTot = BigDecimal.ZERO;
                            }
                            else {
                                dscItem2.setUnitDscAmt(unitDscAmt);
                                manualDiscountTot = manualDiscountTot.subtract(unitDscAmt);
                            }
                            clmItem.setItemLevelDiscAmt(dscItem2.getUnitDscAmt());
                        }
                        if (dscItem2.getTyDsc().compareTo(BigDecimal.ONE) == 0) {
                            if (qtyTot.compareTo(BigDecimal.ONE) == 0) {
                                dscItem2.setUnitDscAmt(tranDiscountTot);
                                tranDiscountTot = BigDecimal.ZERO;
                            }
                            else {
                                dscItem2.setUnitDscAmt(unitDscAmt);
                                tranDiscountTot = tranDiscountTot.subtract(unitDscAmt);
                            }
                            clmItem.setDiscountAmount(dscItem2.getUnitDscAmt());
                        }
                        dscItem2.setDscAmt(dscItem2.getUnitDscAmt());
                        clmDscList.add(dscItem2);
                    }
                    clmItem.setDscList((List)clmDscList);
                }
                catch (Exception e) {
                    ClaimAction.LOGGER.error("Problem ouccured while splitting the discounts for lineItem");
                    throw e;
                }
            }
            qtyTot = qtyTot.subtract(splittedQty);
            splittedLines.add(clmItem);
        }
        ClaimAction.LOGGER.info("Completed splitting the line items and no.of splitted lines for this Item " + claimItem.getItemID() + " are : " + splittedLines.size());
        groupedLineItems.addAll(this.groupItems(splittedLines));
        return groupedLineItems;
    }
    
    private List<ClaimItem> groupItems(final List<ClaimItem> splittedClaimItems) {
        ClaimAction.LOGGER.info("Executing the groupItems method to combine the line items");
        final List<ClaimItem> groupedClaimItems = new ArrayList<ClaimItem>();
        final List<ClaimItem> seperatedClaims = new ArrayList<ClaimItem>();
        final Map<BigDecimal, BigDecimal> map = new LinkedHashMap<BigDecimal, BigDecimal>();
        try {
            BigDecimal qty = BigDecimal.ZERO;
            for (final ClaimItem claimItem : splittedClaimItems) {
                final BigDecimal soldAt = claimItem.getPriceSoldAt();
                if (map.containsKey(soldAt)) {
                    qty = qty.add(BigDecimal.ONE);
                    map.put(soldAt, qty);
                }
                else {
                    qty = BigDecimal.ONE;
                    map.put(soldAt, qty);
                    seperatedClaims.add(claimItem);
                }
            }
            for (final ClaimItem groupedClaimItem : seperatedClaims) {
                groupedClaimItem.setQuantitySold((BigDecimal)map.get(groupedClaimItem.getPriceSoldAt()));
                groupedClaimItem.setClaimQuantityRegistered(groupedClaimItem.getQuantitySold());
                groupedClaimItem.setNetPrice(groupedClaimItem.getPriceSoldAt().multiply(groupedClaimItem.getQuantitySold()));
                if (groupedClaimItem.getDscList() != null) {
                    for (final ClaimTranDscItm dscItem : groupedClaimItem.getDscList()) {
                        if (dscItem.getTyDsc().compareTo(BigDecimal.ZERO) == 0) {
                            groupedClaimItem.setItemLevelDiscAmt(dscItem.getUnitDscAmt().multiply(groupedClaimItem.getQuantitySold()));
                            dscItem.setDscAmt(groupedClaimItem.getItemLevelDiscAmt());
                        }
                        if (dscItem.getTyDsc().compareTo(BigDecimal.ONE) == 0) {
                            dscItem.setDscAmt(dscItem.getUnitDscAmt().multiply(groupedClaimItem.getQuantitySold()));
                            groupedClaimItem.setDiscountAmount(dscItem.getDscAmt());
                        }
                    }
                }
            }
            groupedClaimItems.addAll(seperatedClaims);
            ClaimAction.LOGGER.info("Completed executing groupItems method successfully, Grouped into " + groupedClaimItems.size() + " different lineItems");
        }
        catch (Exception e) {
            ClaimAction.LOGGER.error("Problem ouccured while executing the groupItems method, Issue : " + e.getMessage());
            throw e;
        }
        return groupedClaimItems;
    }
    
    public String addServiceItem() {
        if (this.newClaim != null && this.newClaim.getClaimItemsList() != null) {
            try {
                final LookUpItemIfc itemLookup = DKartContext.getLookupItem();
                final SearchCriteriaIfc searchCriteria = (SearchCriteriaIfc)new SearchCriteria();
                searchCriteria.setItemID(this.serviceItemID);
                final PLUItemIfc serviceItem = itemLookup.lookUpItemById(searchCriteria);
                if (serviceItem == null) {
                    throw new Exception("Service item not found, Item ID:" + this.serviceItemID);
                }
            }
            catch (Exception e) {
                e.printStackTrace();
            }
        }
        return "success";
    }
    
    public String saveClaim() {
        System.out.println(this.newClaim);
        if (this.newClaim == null) {
            return "error";
        }
        ClaimRemote claim = null;
        (this.claimHeader = new ClaimTranHeader()).setIdOpr(this.getEmployee().getEmployeeId());
        this.claimHeader.setEmId(this.newClaim.getSalesAgentId());
        this.claimHeader.setRcRtnMr(this.newClaim.getClaimReasonCode());
        final ClaimTranSum claimSum = new ClaimTranSum();
        claimSum.setOrdIdCt(this.newClaim.getCustomerID());
        this.setSite_address(this.newClaim.getSite_address());
        this.claimHeader.setScTran(new BigDecimal(this.newClaim.getSiteId()));
        this.claimHeader.setCtDvrInf(this.newClaim.getSite_address());
        claimSum.setIdOrdArNmb(this.newClaim.getOriginalInvoiceID());
        claimSum.setIdOrd(this.newClaim.getOriginalOrderID());
        claimSum.setIdEm(this.newClaim.getSalesAgentId());
        this.claimHeader.setClaimTranSum(claimSum);
        this.setReturnReasonCodesMap(this.returnReasonCodesMap = (Map<String, String>)this.getFromSession(DSAction.SESSION.RETURN_REASONCODE_MAP));
        this.removeFromSession(DSAction.SESSION.RETURN_REASONCODE_MAP);
        final List<ClaimTranLineItem> claimLineItems = new ArrayList<ClaimTranLineItem>();
        for (final ClaimItem claimItem : this.newClaim.getClaimItemsList()) {
            if (claimItem.getClaimQuantityRegistered().compareTo(BigDecimal.ZERO) == 1) {
                final ClaimTranLineItem claimTranLineItem = new ClaimTranLineItem();
                claimTranLineItem.setItemId(claimItem.getItemID());
                claimTranLineItem.setDeItmShrtRcpt(claimItem.getItemDescription());
                claimTranLineItem.setRcRtnMr(claimItem.getClaimReasonCode());
                claimItem.setClaimReasonCodeValue((String)this.returnReasonCodesMap.get(claimItem.getClaimReasonCode()));
                claimTranLineItem.setItmTy(BigDecimal.ONE);
                BigDecimal itemPrice = claimItem.getPriceSoldAt();
                BigDecimal itemQty = claimItem.getQuantitySold();
                claimTranLineItem.setLineQnt(itemQty);
                BigDecimal extPrice = itemQty.multiply(claimItem.getUnitPrice());
                BigDecimal totalDiscOnItm = BigDecimal.ZERO;
                if (claimItem.getClaimQuantityRegistered() != null) {
                    itemQty = claimItem.getClaimQuantityRegistered();
                    claimTranLineItem.setLineQntRtn(itemQty);
                    extPrice = itemQty.multiply(claimItem.getUnitPrice());
                }
                if (claimItem.getClaimPriceRegistered() != null) {
                    itemPrice = claimItem.getClaimPriceRegistered();
                    claimTranLineItem.setOvrdPrc(itemPrice);
                    claimTranLineItem.setRcPrcOvrr(claimItem.getPriceChangeReasonCode());
                    extPrice = itemQty.multiply(claimItem.getClaimPriceRegistered());
                }
                final BigDecimal extDiscPr = itemQty.multiply(itemPrice);
                claimTranLineItem.setItmPrnPrc(ConfigUtils.getInstance().createBigDecimal((Object)claimItem.getUnitPrice(), "format.currency"));
                itemQty.compareTo(BigDecimal.ZERO);
                if (claimItem.isServiceItem()) {
                    claimTranLineItem.setItmTy(new BigDecimal(2));
                }
                if (claimItem.getDscList() != null) {
                    ClaimAction.LOGGER.info("discount found  for the lineitem ");
                    final List<ClaimTranDscItm> dscList = new ArrayList<ClaimTranDscItm>();
                    for (final ClaimTranDscItm dscItm : claimItem.getDscList()) {
                        if (dscItm.getTyDsc().compareTo(BigDecimal.ZERO) == 0) {
                            ClaimAction.LOGGER.info("Item level discounts are available for lineItem sequence");
                            if (itemQty.compareTo(BigDecimal.ZERO) == 0) {
                                dscItm.setDscAmt(BigDecimal.ZERO);
                                claimItem.setItemLevelDiscAmt(BigDecimal.ZERO);
                            }
                            else {
                                final BigDecimal disc = ConfigUtils.getInstance().createBigDecimal((Object)dscItm.getUnitDscAmt().multiply(itemQty), "format.currency");
                                claimItem.setItemLevelDiscAmt(disc);
                                dscItm.setDscAmt(disc);
                                ClaimAction.LOGGER.info("adding the item level discounts for ord lineitem sequence ");
                                totalDiscOnItm = totalDiscOnItm.add(claimItem.getItemLevelDiscAmt());
                            }
                        }
                        else if (dscItm.getTyDsc().compareTo(BigDecimal.ONE) == 0) {
                            ClaimAction.LOGGER.info("transaction level discount are available or promotions");
                            if (itemQty.compareTo(BigDecimal.ZERO) == 0) {
                                dscItm.setDscAmt(BigDecimal.ZERO);
                                claimItem.setDiscountAmount(BigDecimal.ZERO);
                            }
                            else {
                                final BigDecimal disc = ConfigUtils.getInstance().createBigDecimal((Object)dscItm.getUnitDscAmt().multiply(itemQty), "format.currency");
                                dscItm.setDscAmt(disc);
                                claimItem.setDiscountAmount(disc);
                                ClaimAction.LOGGER.info("adding the transaction level discount for ord lineitem sequence");
                                totalDiscOnItm = totalDiscOnItm.add(claimItem.getDiscountAmount());
                            }
                        }
                        dscList.add(dscItm);
                    }
                    claimTranLineItem.setClaimTranDscItms((List)dscList);
                    ClaimAction.LOGGER.info("discounts are added successfully to the lineitem sequence");
                    claimTranLineItem.setFlItmDsc("0");
                }
                if (claimItem.getClaimPriceRegistered() != null) {
                    claimTranLineItem.setExtnLnItmRtn(ConfigUtils.getInstance().createBigDecimal((Object)extPrice.add(totalDiscOnItm), "format.currency"));
                }
                else {
                    claimTranLineItem.setExtnLnItmRtn(ConfigUtils.getInstance().createBigDecimal((Object)extPrice, "format.currency"));
                }
                claimTranLineItem.setExtnDscLnItm(ConfigUtils.getInstance().createBigDecimal((Object)extDiscPr, "format.currency"));
                claimLineItems.add(claimTranLineItem);
            }
        }
        this.claimHeader.setClaimTranLineItems((List)claimLineItems);
        try {
            claim = DKartContext.getClaimBean();
            final LookUpEmployeeIfc lkupemp = DKartContext.getLookupEmployee();
            final EmployeeSearchCriteriaIfc empcrt = (EmployeeSearchCriteriaIfc)new EmployeeSearchCriteria();
            this.claimHeader.setScOrd(BigDecimal.ONE);
            this.claimHeader = claim.saveClaimTranHeader(this.claimHeader);
            new ClaimEmail().sendClaimRegisterEmail(this.claimHeader);
            if (this.claimHeader == null) {
                throw new Exception("Did not receive saved claim details!");
            }
            this.newClaim.setClaimID(this.claimHeader.getClaimId());
            this.newClaim.setClaimDate(new Date());
            this.newClaim.setClaimReasonCodeDesc((String)this.returnReasonCodesMap.get(this.claimHeader.getRcRtnMr()));
            this.claimTotals[0] = this.claimHeader.getClaimTranSum().getDkartSlsTot();
            this.claimTotals[1] = this.claimHeader.getClaimTranSum().getDkartExpenses();
            this.claimTotals[2] = this.claimHeader.getClaimTranSum().getDkartNetTot();
            this.claimTotals[3] = this.claimHeader.getClaimTranSum().getDkartDscTot();
            empcrt.setEmployeeId(this.claimHeader.getEmId());
            final EmployeeIfc[] emp = lkupemp.lookupSalesAgent(empcrt);
            if (emp != null && emp.length > 0) {
                this.setSalesAgentName(emp[0].getEmployeeName());
            }
        }
        catch (Exception e) {
            e.printStackTrace();
            this.addActionError(e.getMessage());
            return "error";
        }
        return "success";
    }
    
    public List<ClaimTranSum> removeRejectClaims(final List<ClaimTranSum> existingClaimTranSum) {
        ClaimAction.LOGGER.info("Inside the removeRejectClaims() method");
        List<ClaimTranSum> existingClaimTranSumlist = null;
        existingClaimTranSumlist = existingClaimTranSum;
        final Iterator<ClaimTranSum> existingClaims = existingClaimTranSumlist.iterator();
        while (existingClaims.hasNext()) {
            final ClaimTranSum existingClaim = existingClaims.next();
            if (existingClaim != null && existingClaim.getClaimTranHeader() != null && existingClaim.getClaimTranHeader().getScOrd().compareTo(new BigDecimal(6)) == 0) {
                existingClaims.remove();
                ClaimAction.LOGGER.info("Removed Reject Claim ID :" + existingClaim.getClaimTranHeader().getClaimId());
            }
        }
        ClaimAction.LOGGER.info("End of removeRejectClaims() method");
        return existingClaimTranSumlist;
    }
    
    public String claimsToApprove() {
        return "success";
    }
    
    public String cancelClaim() {
        this.removeFromSession(DSAction.SESSION.ORDER_TRANSACTION);
        this.removeFromSession(DSAction.SESSION.CUSTOMER);
        return "success";
    }
    
    public ClaimTranHeader getClaimHeader() {
        return this.claimHeader;
    }
    
    public void setClaimHeader(final ClaimTranHeader claimHeader) {
        this.claimHeader = claimHeader;
    }
    
    public String getInvoiceOrOrderID() {
        return this.invoiceOrOrderID;
    }
    
    public void setInvoiceOrOrderID(final String invoiceOrOrderID) {
        this.invoiceOrOrderID = invoiceOrOrderID;
    }
    
    public String getClaimJson() {
        return this.claimJson;
    }
    
    public void setClaimJson(final String claimJson) {
        this.claimJson = claimJson;
    }
    
    public Claim getNewClaim() {
        return this.newClaim;
    }
    
    public void setNewClaim(final Claim newClaim) {
        this.newClaim = newClaim;
    }
    
    public String getServiceItemID() {
        return this.serviceItemID;
    }
        
    public void setServiceItemID(final String serviceItemID) {
        this.serviceItemID = serviceItemID;
    }
    
    public BigDecimal[] getClaimTotals() {
        return this.claimTotals;
    }
    
    public Map<String, String> getReturnReasonCodesMap() {
        return this.returnReasonCodesMap;
    }
    
    public void setReturnReasonCodesMap(final Map<String, String> returnReasonCodesMap) {
        this.returnReasonCodesMap = returnReasonCodesMap;
    }
    
    public String getReturnReasoncodes() {
        return this.returnReasoncodes;
    }
    
    public void setReturnReasoncodes(final String returnReasoncodes) {
        this.returnReasoncodes = returnReasoncodes;
    }
    
    public Boolean getRegClaimPerWthOutInv() {
        return this.RegClaimPerWthOutInv;
    }
    
    public void setRegClaimPerWthOutInv(final Boolean regClaimPerWthOutInv) {
        this.RegClaimPerWthOutInv = regClaimPerWthOutInv;
    }
    
    public boolean getManagerOverride() {
        try {
            this.managerOverride = DKartContext.getParamterBean().fetchXMLParameterValues().getEnableRegisterClaimManagerOveride().equalsIgnoreCase("YES");
        }
        catch (Exception e) {
            ClaimAction.LOG.error(e.getMessage(), e.getCause());
        }
        return this.managerOverride;
    }
    
    public Map<String, String> getPriceChangeReasonCodeMap() {
        return this.priceChangeReasonCodeMap = (Map<String, String>)ReasonCodes.getPriceOrrReasonCode();
    }
    
    public String getSalesAgentName() {
        return this.salesAgentName;
    }
    
    public void setSalesAgentName(final String salesAgentName) {
        this.salesAgentName = salesAgentName;
    }
    
    public String getSite_address() {
        return this.site_address;
    }
    
    public void setSite_address(final String site_address) {
        this.site_address = site_address;
    }
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               